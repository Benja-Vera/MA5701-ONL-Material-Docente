\documentclass{article}
\input{imports.tex}
\input{config.tex}

\begin{document}
\input{datos-ONL.tex}

\begin{center}
    \Huge{\textbf{Auxiliar 1}}\\
\textit{\large{Condiciones de optimalidad}}\\
    \normalsize
	20 de marzo de 2025
\end{center}

\noindent Consideremos el siguiente problema parametrizado por \(x \in \X \subseteq \R^n\):
\begin{align*} \label{follower}
	\min_{y \in \R^m} & f(x, y) \tag{F} \\
	& g(x, y) \leq 0
\end{align*}	
Con \(g = (g_i)_{i = 1}^p\) en que \(f(x, \cdot), g_i(x, \cdot) : \R^m \to \R\) son funciones convexas y \(\C^1\) para \(i = 1, \dots, p\) y \(x \in \X\) fijo. Digamos que el problema \ref{follower} tiene conjunto solución \(\Psi(x) \subseteq \R^m\). Dada \(F(x, y)\) continua en ambas variables, consideramos la formulación optimista del problema binivel
\begin{align*} \label{bilevel-problem}
	\min_{x \in \X, y \in \R^m}	& F(x, y) \tag{BP} \\
	& y \in \Psi(x)
\end{align*}
En esta clase, vamos a estudiar la \textit{transformación de KKT} que reduce el problema \ref{bilevel-problem} a uno con restricciones de complementariedad utilizando las condiciones de primer orden sobre \ref{follower}. Esto nos entrega el siguiente problema:
\begin{align*} \label{KKT-bilevel-problem}
	\min_{x, y, u} & \;F(x, y) \tag{MPEC} \\
				   & x \in \X \\
				   & \grad_y L(x, y, u) = 0 \\
				   & (g(x, y) \leq 0) \perp (u \geq 0)
\end{align*}
en que \(L(x, y, u) := f(x, y) + u^\top g(x, y)\) define al lagrangeano del problema.
\begin{enumerate}
	\item \textbf{(Propuesto)} Pruebe que si \((\overline{x}, \overline{y})\) es solución del problema \ref{bilevel-problem} y la condición de Slater para \ref{follower} se cumple en \(\overline{x}\), entonces para todo \(\overline{u} \in \Lambda(\overline{x}, \overline{y})\) dado por
		\[\Lambda(\overline{x}, \overline{y}) := \qty{ u \geq 0 : \grad_y L(\overline{x}, \overline{y}, u) = 0, u^\top g(\overline{x}, \overline{y}) = 0},\]
		el punto \((\overline{x}, \overline{y}, \overline{u})\) es solución de \ref{KKT-bilevel-problem}.
	\item
		\begin{enumerate}
			\item Considere el siguiente problema parametrizado por \(x \geq 0\):
				\begin{align*}
					\min_{y_1, y_2} & \;y_1 \\
									& y_1^2 - y_2 \leq x \\
									& y_1^2 + y_2 \leq 0.
				\end{align*}
			Obtenga la solución de este problema y sus multiplicadores \(u_1, u_2 \geq 0\) (en caso de que existan) para \(x \geq 0.\)

			\textit{Indicación:} Analice por separado \(x = 0\) y \(x > 0\).
		\item Ahora, considerando el problema binivel
			\begin{align*}
				\min_{x \geq 0} & \;x \\
								& y \in \Psi(x),
			\end{align*}
			explique por qué la hipótesis de Slater en la pregunta anterior es necesaria.
		\end{enumerate}
	\item Ahora, asuma que la condición de Slater se cumple para \ref{follower} para \textbf{todo} punto \(x \in \X\) y sea \((\overline{x}, \overline{y}, \overline{u})\) solución de \ref{KKT-bilevel-problem}. Pruebe que entonces \((\overline{x}, \overline{y})\) es solución de \ref{bilevel-problem}.
\end{enumerate}

\end{document}
